<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      th:replace="~{fragments/layout :: layout (~{::body},'index')}">

<body>
<div class="kt-container-fluid">
    <div class="grid lg:grid-cols-1 gap-5 lg:gap-7.5 items-stretch">

        <div class="col-span-2">
            <div class="kt-card">
                <div class="kt-card-header">
                    <h3 class="kt-card-title">Data</h3>
                </div>

                <div class="kt-card-content">
                    <!-- DataTables CSS (CDN) -->
                    <link rel="stylesheet"
                          th:href="@{https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css}"/>

                    <div class="table-responsive">
                        <table id="dataTable" class="display table w-full min-w-[1000px]">
                            <thead>
                            <tr>
                                <th>ID</th>
                                <th>Uploaded At</th>
                                <th>Contributor</th>
                                <th>Project Name</th>
                                <th>Status</th>
                                <th>Actions</th>
                                <th>Verificator</th>
                                <th>Verification Time</th>
                            </tr>
                            </thead>
                            <tbody>
                            <!-- SSR fallback if JS disabled -->
                            <tr th:each="d : ${data}">
                                <td style="width:5%" th:text="${d.id}"></td>
                                <td style="width:15%"><span th:text="${#dates.format(d.createdAt, 'dd MMM yyyy, HH:mm')}"></span></td>
                                <td style="width:15%" th:text="${d.user != null ? d.user.fullName : ''}"></td>
                                <td style="width:10%" th:text="${d.project != null ? d.project.name : ''}"></td>
                                <td style="width:15%">
                                    <span th:if="${d.status == 0}"
                                                            class="kt-badge kt-badge-sm kt-badge-outline kt-badge-warning">Pending for verification</span>
                                    <span th:if="${d.status == 1}"
                                          class="kt-badge kt-badge-sm kt-badge-outline kt-badge-success">Approved</span>
                                    <span th:if="${d.status == 2}"
                                          class="kt-badge kt-badge-sm kt-badge-outline kt-badge-destructive">Rejected</span></td>
                                <td style="width:10%">
                                    <a th:href="@{|/record/${d.id}|}"
                                       class="kt-btn kt-btn-light">Detail</a>
                                </td>
                                <td style="width:15%" th:text="${d.verificator != null ? d.verificator.fullName : ''}"></td>
                                <td style="width:15%"><span th:text="${#dates.format(d.verifiedAt, 'dd MMM yyyy, HH:mm')}"></span></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- jQuery + DataTables (CDN) -->
                    <script th:src="@{https://code.jquery.com/jquery-3.7.1.min.js}"></script>
                    <script th:src="@{https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js}"></script>
                    <script>
                        $(function () {
                            $('#dataTable').DataTable({
                                scrollX: true,        // enable horizontal scrolling
                                autoWidth: false,     // keep your widths; donâ€™t auto-expand
                                columnDefs: [
                                    {targets: '_all', className: 'whitespace-nowrap'}
                                ]
                            });
                        });
                    </script>
                </div>
            </div>
        </div>

    </div>
</div>
</body>
</html>
